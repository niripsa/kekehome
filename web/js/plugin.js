/*window.onerror = function(){return true;};*/

function jquery_trOverStyle(a,b){a.mouseover(function(){$(this).find("td").addClass(b)});a.mouseout(function(){$(this).find("td").removeClass(b)})}
function jquery_submitBtnDis(o,s){if(isIE()==true){var b=$(o);b.attr("disabled","true");b.attr("value",s);return true}else{return true}}
function jquery_submitAllBtnDis(){$("input[type='submit']").attr("disabled","true");$("input[type='button']").attr("disabled","true");return true;}
function jquery_preloadImages(){for(var i=0;i<arguments.length;i++){$("<img>").attr("src",arguments[i]);}}
function jquery_keyAdminLock(){$(document).keydown(function(e){if(e.keyCode==8){return false;}if(e.keyCode==116){if($.browser.msie){event.keyCode=0;}return false;}if(e.ctrlKey&&e.keyCode==82){return false;}});}
function jquery_addHideIframe(i,s){if($("#"+i).attr("src")){$("#"+i).attr("src",urlAddRndNum(s));}else{$("body").append("<iframe id='"+i+"' name='"+i+"' src='"+s+"' style='display:none;'></iframe>");}}
function jquery_iframeWrite(i,s){var d=$$$(i).contentWindow.document;d.open();d.writeln(s);d.close();}
function jquery_banFrame(){if(top.location!=self.location)top.location=self.location;}

jQuery.fn.style_dropShadowBox=function(){if($(this).eq(0).attr("src")){$(this).wrap('<div class="ds_w0"><div class="ds_w1"><div class="ds_w2"><div class="ds_w3"></div></div></div></div>');$(".ds_w0").after('<div class="clear"></div>');}else{$(this).wrap('<div class="ds_w0"><div class="ds_w1"><div class="ds_w2"><div class="ds_w3"><div class="ds_box"></div></div></div></div></div>');$(".ds_w0").after('<div class="clear"></div>');}}
jQuery.fn.style_shadowBox=function(){if($(this).eq(0).attr("src")){$(this).wrap('<div class="s_w0"></div>');$(".s_w0").after('<div class="clear"></div>');}else{$(this).wrap('<div class="s_w1"><div class="s_w2"><div class="s_w3"></div></div></div>');$(".s_w1").after('<div class="clear"></div>');}}
jQuery.fn.style_roundedBox=function(){function _jquery_roundedBox(a,b,c,d,e,f){$(a).wrap('<div class="rb_'+c+'" id="rbid_'+b+'"><div class="box"></div></div>');var rbStr="#rbid_"+b;var oRB=$(rbStr);if(d) oRB.css("width",d);switch(c){case 4:oRB.prepend('<div class="l1"></div>').append('<div class="l1"></div>').after('<div class="clear"></div>');break;case 3:oRB.prepend('<div class="l1"></div><div class="l2"></div><div class="l3">').append('<div class="l3"></div><div class="l2"></div><div class="l1"></div>').after('<div class="clear"></div>');break;case 2:oRB.prepend('<div class="l1"></div><div class="l2"></div><div class="l3">').append('<div class="l3"></div><div class="l2"></div><div class="l1"></div>').after('<div class="clear"></div>');break;default:oRB.prepend('<div class="l1"></div><div class="l2"></div><div class="l3"></div><div class="l4"></div>').append('<div class="l4"></div><div class="l3"></div><div class="l2"></div><div class="l1"></div>').after('<div class="clear"></div>');break;}if(e){$(rbStr+" .l1").css("backgroundColor",e);$(rbStr+" .l2").css("borderColor",e);$(rbStr+" .l3").css("borderColor",e);$(rbStr+" .l4").css("borderColor",e);$(rbStr+" .box").css("borderColor",e);}if(f){$(rbStr+" .l2").css("backgroundColor",f);$(rbStr+" .l3").css("backgroundColor",f);$(rbStr+" .l4").css("backgroundColor",f);$(rbStr+" .box").css("backgroundColor",f);}}$(this).each(function(i){var c=this.className;var s=cInt(showUrlPara(c,"style"));if(s<=0)s=1;var w=showUrlPara(c,"width");if(!isValue(w))w=null;var b=showUrlPara(c,"borderColor");if(!isValue(b))b=null;var g=showUrlPara(c,"backgroundColor");if(!isValue(g))g=null;_jquery_roundedBox(this,i,s,w,b,g);});}
jQuery.fn.checkbox_select=function(t){var t=t||"on";$(this).each(function(){switch(t){case "on":this.checked=true;break;case "off":this.checked=false;break;case "toggle":this.checked=!this.checked;break;}});}
jQuery.fn.QQBox=function(o){o=$.extend({top:60,left:0,right:0,width:100,height:360,minScreenW:800,position:"left"},o||{});var h=o.height;var showAd=true;var d=$(this);if(o.minScreenW>=$(window).width()){d.hide();showAd=false;}else{d.css("display","block");switch(o.position){case "left":d.css({position:"absolute",left:o.left+"px",top:o.top+"px",width:o.width+"px",height:h+"px",overflow:"hidden"});break;case "right":d.css({position:"absolute",left:"auto",right:o.right+"px",top:o.top+"px",width:o.width+"px",height:h+"px",overflow:"hidden"});break;};};function r(){if(!showAd){return;}var windowTop=$(window).scrollTop();if(d.css("display")!="none")d.css("top",o.top+windowTop+"px");};$(window).scroll(r);}
jQuery.fn.key_enterToNextInput=function(){$(this).keydown(function(e){if(e.keyCode==13){var b=this;var a=null;var c=$(b);while(a==null){c=c.parent();var d=lCase(c.attr("tagName"));if(c=="form"||c=="body"){a=c}if(!c.parent().html()){a=c}}var m=a.find(":input[type!='hidden'][type!='button'][type!='reset']");var t=0;m.each(function(i){if(this.id==b.id)t=i});t=++t%m.length;m.eq(t).focus();return false}})}
jQuery.fn.key_onlyCN=function(){$(this).keyup(function(e){this.value=this.value.replace(/[ -~]/g,"");});$(this).bind("contextmenu",function(e){return false;});}
jQuery.fn.key_notCN=function(){$(this).keyup(function(e){this.value=this.value.replace(/[\u4e00-\u9fa5]/g,"");});$(this).bind("contextmenu",function(e){return false;});}
jQuery.fn.key_onlyLetterOrNumberOrUnderline=function(){$(this).keyup(function(e){this.value=this.value.replace(/[\W]/g,"");});$(this).bind("contextmenu",function(e){return false;});}
jQuery.fn.key_onlyLetterOrNumber=function(){$(this).keyup(function(e){this.value=this.value.replace(/[\W]/g,"").replace(/_/g,"");});$(this).bind("contextmenu",function(e){return false;});}
jQuery.fn.key_onlyNumber=function(){$(this).keyup(function(e){this.value=this.value.replace(/[^\d]/g,"");});$(this).bind("contextmenu",function(e){return false;});}
jQuery.fn.key_onlyNumberOrLine=function(){$(this).keyup(function(e){this.value=this.value.replace(/[^\d|\-]/g,"");});$(this).bind("contextmenu",function(e){return false;});}
jQuery.fn.key_onlyNumberOrDP=function(){$(this).keyup(function(e){this.value=this.value.replace(/[^\d|\.]/g,"");});$(this).bind("contextmenu",function(e){return false;});}
jQuery.fn.key_imeDisabled=function(){$(this).css("ime-mode","disabled");}
jQuery.fn.key_readonly=function(){$(this).attr("readonly","readonly");}
jQuery.fn.key_disabled=function(){$(this).attr("disabled","disabled");}
jQuery.fn.key_historyDis=function(){$(this).attr("autocomplete","off");}
jQuery.fn.css_grayscale=function(){$(this).css("filter","progid:DXImageTransform.Microsoft.BasicImage(grayscale=1)");}
jQuery.fn.css_opacity=function(n){m=returnFloat(n/100);$(this).css("filter","alpha(opacity="+n+")").css("opacity",m).css("-moz-opacity",m).css("-khtml-opacity",m);}
jQuery.fn.css_center=function(p){var o_={x:true,y:true,adX:0,adY:0};var op=$.extend(o_,p);$(this).each(function(){var s=$(this);var width=s.width();var height=s.height();var pt=cInt(s.css("padding-top"));var pb=cInt(s.css("padding-bottom"));var bt=cInt(s.css("border-top-width"));var bb=cInt(s.css("border-bottom-width"));var mb=(bt+bb)/2;var mp=(pt+pb)/2;var pt=s.parent().css("position");var hw=(width/2)*(-1);var hh=((height/2)*(-1))-mp-mb;var cp={position: "absolute"};if(op.x){cp.height=height;cp.top="50%";cp.marginTop=hh+op.adX;}if(op.y){cp.width=width;cp.left="50%";cp.marginLeft=hw+op.adY;}if(p=="static"){s.parent().css("position","relative");}s.css(cp);});}
jQuery.fn.css_equalHeights=function(a,b){c=(a)?a:0;this.each(function(){if($(this).height()>c){c=$(this).height();}});if((b)&&c>b)c=b;return this.each(function(){$(this).height(c).css("overflow","auto");});}
jQuery.fn.css_equalWidths=function(a,b){c=(a)?a:0;this.each(function(){if($(this).width()>c){c=$(this).width();}});if((b)&&c>b)c=b;return this.each(function(){$(this).width(c).css("overflow","auto");});}
jQuery.fn.selectColor=function(o){$(this).css("cursor","pointer");function setObjColor(o,v,c){switch(lCase(v)){case"background-color":$(o).css("background-color",c);break;case"value":$(o).val(c);break;case"innerhtml":$(o).html(c);break;case"color":$(o).css("color",c);break}}$(this).click(function(){var s=selectColor();var d=false;if(isValue(s)){for(a in o){var b=o[a].split("|");for(var i=0;i<b.length;i++){setObjColor(a,b[i],s)}d=true}if(d==false){$(this).val(s)}}})}
jQuery.fn.selectDateA=function(d,o){$(this).css("cursor","pointer");var e=o;if((typeof d!="string")){if((typeof d=="object")){e=d}d=""}function setObjValue(o,v,c){switch(lCase(v)){case"value":$(o).val(c);break;case"innerhtml":$(o).html(c);break}}$(this).click(function(){var s=selectDateA(d);var b=false;if(isValue(s)){for(a in e){setObjValue(a,e[a],s);b=true}if(b==false){$(this).val(s)}}})}
jQuery.fn.mouseTipsA=function(m){var a="",av="";var avArr,writeAv;var tipsId="mouseTipsA-Box";if($("#"+tipsId).length<=0){$("body").append('<div id="'+tipsId+'"><div class="line"><div class="arrow"></div></div><div class="info"><div class="txt"></div></div></div>')}function getAV(t,inM){a=inM;av=t.attr(a);if(isValue(av)){t.attr(a,"")}}function mouseMove(ev){var o=mouseXY(ev);var b=bodyScrollTL();var t=mouseTipsXY(ev);var adX=60;var tipsX=t.x-adX;var tipsY=t.y;if(o.x+$("#"+tipsId).width()-40-adX>$("body").width()){tipsX=b.l+$("body").width()-$("#"+tipsId).width()+40}else if(o.x-adX+10<0){tipsX=b.l-10}$("#"+tipsId).css("left",tipsX);$("#"+tipsId).css("top",tipsY);$("#"+tipsId+" div[class=txt]").html(writeAv)}$(this).hover(function(){if(m){getAV($(this),m)}if(!isValue(av)){getAV($(this),"title")}if(!isValue(av)){getAV($(this),"alt")}if(!isValue(av)){return}avArr=av.split("|");if(avArr.length==2)writeAv="<b>"+avArr[0]+"</b><br />"+avArr[1];else writeAv=av;$("#"+tipsId).css("display","block");if(!$(this).data("events")["mousemove"]){$(this).bind("mousemove",mouseMove);$("body").css("cursor","help")}},function(){$("#"+tipsId).css("display","none");if($(this).data("events")["mousemove"]){$(this).unbind("mousemove",mouseMove);$("body").css("cursor","default");$(this).attr(a,av);a="";av=""}})}
jQuery.fn.loadImg=function(url){var obj=this;var img=new Image();img.src=url;var w=$(obj).attr("width");if(w<=0)w=85;var h=$(obj).attr("height");if(h<=0)h=85;$(obj).attr({"src":"/jqueryPublic/loadImgS.gif","width":w,"height":h});$(obj).css("background","url(/jqueryPublic/loadImgloading.gif) 50% 50% no-repeat");if(!img.complete){$(img).bind("error load onreadystatechange",function(){$(obj).attr("src",url)})}else{$(obj).attr("src",url);}}

function js_marquee(o){this.ID=$$$(o.id);if(!this.ID){alert("js_marquee ID “"+o.id+"” configuration error!");this.ID=-1;return;}this.Direction=this.Width=this.Height=this.DelayTime=this.WaitTime=this.CTL=this.StartID=this.Stop=this.MouseOver=0;this.Step=1;this.Timer=30;this.DirectionArray = {"上":0,"0":0,"top":0,"up":0,"下":1,"2":1,"bottom":1,"down":1,"左":2,"3":2,"left":2,"右":3,"1":3,"right":3};switch(o.direction){case "上":case "top":case "up":case "0":this.Direction=0;break;case "右":case "right":case "1":this.Direction=3;break;case "下":case "down":case "bottom":case "2":this.Direction=1;break;default:this.Direction=2;break;}if(o.step)this.Step=o.step;if(o.width)this.Width=o.width;if(o.height)this.Height=o.height;if(o.timer)this.Timer=o.timer;if(o.delayTime)this.DelayTime=o.delayTime;if(o.waitTime)this.WaitTime=o.waitTime;if(o.scrollStep)this.ScrollStep=o.scrollStep;this.ID.style.overflow=this.ID.style.overflowX=this.ID.style.overflowY="hidden";this.ID.noWrap=true;this.IsNotOpera=(navigator.userAgent.toLowerCase().indexOf("opera")==-1);if(o.start != false)this.Start();}js_marquee.prototype.Start=function(){if(this.ID==-1)return;if(this.WaitTime < 800)this.WaitTime=50;if(this.Timer < 20)this.Timer=20;if(this.Width==0)this.Width=parseInt(this.ID.style.width);if(this.Height==0)this.Height=parseInt(this.ID.style.height);if(typeof this.Direction=="string")this.Direction=this.DirectionArray[this.Direction.toString().toLowerCase()];this.HalfWidth=Math.round(this.Width/2);this.HalfHeight=Math.round(this.Height/2);this.BakStep=this.Step;this.ID.style.width=this.Width+"px";this.ID.style.height=this.Height+"px";if(typeof this.ScrollStep != "number")this.ScrollStep=this.Direction>1 ? this.Width : this.Height;var templateLeft="<table cellspacing='0' cellpadding='0' style='border-collapse:collapse;display:inline;'><tr><td noWrap=true style='white-space: nowrap;word-break:keep-all;'>MSCLASS_TEMP_HTML</td><td noWrap=true style='white-space: nowrap;word-break:keep-all;'>MSCLASS_TEMP_HTML</td></tr></table>";var templateTop="<table cellspacing='0' cellpadding='0' style='border-collapse:collapse;'><tr><td>MSCLASS_TEMP_HTML</td></tr><tr><td>MSCLASS_TEMP_HTML</td></tr></table>";var msobj=this;msobj.tempHTML=msobj.ID.innerHTML;if(msobj.Direction<=1){msobj.ID.innerHTML=templateTop.replace(/MSCLASS_TEMP_HTML/g,msobj.ID.innerHTML);}else{if(msobj.ScrollStep==0&&msobj.DelayTime==0){msobj.ID.innerHTML+=msobj.ID.innerHTML;}else{msobj.ID.innerHTML=templateLeft.replace(/MSCLASS_TEMP_HTML/g,msobj.ID.innerHTML);}}var timer=this.Timer;var delaytime=this.DelayTime;var waittime=this.WaitTime;msobj.StartID=function(){msobj.Scroll();};msobj.Continue=function(){if(msobj.MouseOver==1){setTimeout(msobj.Continue,delaytime);}else{clearInterval(msobj.TimerID);msobj.CTL=msobj.Stop=0;msobj.TimerID=setInterval(msobj.StartID,timer);}};msobj.Pause=function(){msobj.Stop=1;clearInterval(msobj.TimerID);setTimeout(msobj.Continue,delaytime);};msobj.Begin=function(){msobj.ClientScroll=msobj.Direction>1 ? msobj.ID.scrollWidth/2 : msobj.ID.scrollHeight/2;if((msobj.Direction<=1&&msobj.ClientScroll<=msobj.Height+msobj.Step)||(msobj.Direction>1&&msobj.ClientScroll<=msobj.Width+msobj.Step)){msobj.ID.innerHTML=msobj.tempHTML;delete(msobj.tempHTML);return;}delete(msobj.tempHTML);msobj.TimerID=setInterval(msobj.StartID,timer);if(msobj.ScrollStep < 0)return;msobj.ID.onmousemove=function(event){if(msobj.ScrollStep==0&&msobj.Direction>1){var event=event||window.event;if(window.event){if(msobj.IsNotOpera){msobj.EventLeft=event.srcElement.id==msobj.ID.id ? event.offsetX-msobj.ID.scrollLeft : event.srcElement.offsetLeft-msobj.ID.scrollLeft+event.offsetX;}else{msobj.ScrollStep=null;return;}}else{msobj.EventLeft=event.layerX-msobj.ID.scrollLeft;}msobj.Direction=msobj.EventLeft>msobj.HalfWidth?3:2;msobj.AbsCenter=Math.abs(msobj.HalfWidth-msobj.EventLeft);msobj.Step=Math.round(msobj.AbsCenter * (msobj.BakStep*2)/msobj.HalfWidth);}};msobj.ID.onmouseover=function(){if(msobj.ScrollStep==0)return;msobj.MouseOver=1;clearInterval(msobj.TimerID);};msobj.ID.onmouseout=function(){if(msobj.ScrollStep==0){if(msobj.Step==0)msobj.Step=1;return;}msobj.MouseOver=0;if(msobj.Stop==0){clearInterval(msobj.TimerID);msobj.TimerID=setInterval(msobj.StartID,timer);}};};setTimeout(msobj.Begin,waittime);};js_marquee.prototype.Scroll=function(){switch(this.Direction){case 0:this.CTL+=this.Step;if(this.CTL>=this.ScrollStep&&this.DelayTime>0){this.ID.scrollTop+=this.ScrollStep+this.Step-this.CTL;this.Pause();return;}else{if(this.ID.scrollTop>=this.ClientScroll){this.ID.scrollTop-=this.ClientScroll;}this.ID.scrollTop+=this.Step;}break;case 1:this.CTL+=this.Step;if(this.CTL>=this.ScrollStep&&this.DelayTime>0){this.ID.scrollTop-=this.ScrollStep+this.Step-this.CTL;this.Pause();return;}else{if(this.ID.scrollTop<=0){this.ID.scrollTop+=this.ClientScroll;}this.ID.scrollTop-=this.Step;}break;case 2:this.CTL+=this.Step;if(this.CTL>=this.ScrollStep&&this.DelayTime>0){this.ID.scrollLeft+=this.ScrollStep+this.Step-this.CTL;this.Pause();return;}else{if(this.ID.scrollLeft>=this.ClientScroll){this.ID.scrollLeft-=this.ClientScroll;}this.ID.scrollLeft+=this.Step;}break;case 3:this.CTL+=this.Step;if(this.CTL>=this.ScrollStep&&this.DelayTime>0){this.ID.scrollLeft-=this.ScrollStep+this.Step-this.CTL;this.Pause();return;}else{if(this.ID.scrollLeft<=0){this.ID.scrollLeft+=this.ClientScroll;}this.ID.scrollLeft-=this.Step;}break;}}
function js_serverTimerCn(i,o){var t=new Date(Date.parse(new Date(o))+1000*1);var w=new Array("日","一","二","三","四","五","六");var m=t.getMinutes();if(m<10)m="0"+m;var s=t.getSeconds();if(s<10)s="0"+s;var a=t.getYear()+"年"+(t.getMonth()+1)+"月"+t.getDate()+"日 星期"+w[t.getDay()]+" "+t.getHours()+":"+m+":"+s;$(i).html(a);setTimeout("js_serverTimerCn('"+i+"','"+t+"')",1000);}
function js_serverTimerEn(i,o){var t=new Date(Date.parse(new Date(o))+1000*1);var w=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");var b=new Array("January","February","March","April","May","June","July","August","September","October","November","December");var ap="am";var h=t.getHours();if(h>12){h=h-12;ap="pm";}var m=t.getMinutes();if(m<10)m="0"+m;var s=t.getSeconds();if(s<10)s="0"+s;var a=b[t.getMonth()]+t.getDate()+","+t.getYear()+","+h+":"+m+":"+s+ap+","+w[t.getDay()];$(i).html(a);setTimeout("js_serverTimerEn('"+i+"','"+t+"')",1000);}

function showUrlPara(u,p){u=lCase(u);var e=new RegExp("(^|&)"+lCase(p)+"=([^&]*)(&|$)");var r=u.substr(u.indexOf("\?")+1).match(e);if(r!=null) return r[2];else return "";}
function urlGet(p){return showUrlPara(window.location.href,p);}
function cInt(s) { var t = parseInt(s); if (isNaN(t)) t = 0; return t; }
function cDouble(s) { var t = parseFloat(s); if (isNaN(t)) t = 0; return t; }
function lCase(s){return s.toLowerCase();}
function uCase(s){return s.toUpperCase();}
function $$$(){if(typeof(arguments[0])=="string"){return document.getElementById?document.getElementById(arguments[0]):eval(arguments[0]);}else{return arguments[0];}}
function hintAndTurn(s,u){if(confirm(s)){window.location.href=u;return true;}else{return false;}}
function getDomain(u){var t="";var r=/.*\:\/\/([^\/]*).*/;var m=u.match(r);if (null!=m)t=m[1];return t;}
function removeDomain(u){var t=u;var f=-1;if (t.toLowerCase().substring(0,7)=="http://"){t=t.substring(7,t.length);f=t.indexOf("/");if(f>=0){t=t.substring(f,t.length);}}return t;}
function fileIsImage(f){var d=f.lastIndexOf(".");var i=false;if(d>=0){var e=f.substring(d,f.length);e=e.replace(".","").toLowerCase();e=","+e+",";if(",png,jpg,jpeg,gif,bmp,".indexOf(e)>=0){i=true;}}return i;}
function imgSizeReSet(o,w,h){var i=new Image();i.src=o.src;var iw=i.width;var ih=i.height;if(iw>0&&ih>0){if(iw/ih>=w/h){if(iw>w){o.width=w;o.height=(ih*w)/iw;}else{o.width=iw;o.height=ih;}} else {if(ih>h){o.height=h;o.width=(iw*h)/ih;}else{o.width=iw;o.height=ih;}}}}
function left(m,l){if(l>0){return m.substring(0,l);}else{return "";}}
function right(m,l){var ml=m.length;if(ml>0&&l>0){if(ml>l)return m.substring(ml-l);else return m;}else{return "";}}
function mid(m,s,e){if(m.length>=0){return m.substr(s,e);}else{return "";}}
function trim(s){return $.trim(s);}
function aLinkClick(i){if(document.all){$$$(i).click();return true;}else{/*var e=document.createEvent("MouseEvent");e.initEvent("click",true,true);$$$(i).dispatchEvent(e);*/return false;}}
function returnFloat(v){var t=Math.round(parseFloat(v)*100)/100;if (t.toString().indexOf(".")<0){t=t.toString()+".00";}return t;}
function formatSecondTime(t){var h=t/3600|0;var m=(t%3600)/60|0;var s=(t%3600)%60;if(h<10){h="0"+h;}if(m<10){m="0"+m;}if(s<10){s="0"+s;}return h+":"+m+":"+s;}
function formatSecondTimeCN(t){var h=t/3600|0;var m=(t%3600)/60|0;var s=(t%3600)%60;var r="";if(h>0)r+=h+"时";r+=m+"分";r+=s+"秒";return r;}
function isNumber(s){return !/[^0-9]/g.test(s);}
function isEmail(s){var p=/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/;if(!p.exec(s))return false;else return true;}
function isLetter(s){return !/[^A-Za-z]/g.test(s);}
function isLetterOrNumber(s){return !/[^0-9A-Za-z]/g.test(s);}
function getMonthDays(y,m){var d=31;if(m==4||m==6||m==9||m==11){d=30;}else if(m==2){if(y%4!=0)d=28;else if(targetyear%4==0)d=29;}return d;}
function getConstellation(m,d){var c=new Array("水瓶座","双鱼座","白羊座","金牛座","双子座","巨蟹座","狮子座","处女座","天秤座","天蝎座","射手座","摩羯座");var s=new Array(20,19,21,21,21,22,23,23,23,23,22,22);m=m-1;if(d<s[m]){if(m==0)m=12;m=m-1;}if(m>=0){return c[m];}}
function isValue(o){return !(typeof o=="undefined"||null==o||""==o);}
function copyTxt(v,t){function _copyToClipboard(txt){if(window.clipboardData){window.clipboardData.clearData();window.clipboardData.setData("Text",txt);}else if(navigator.userAgent.indexOf("Opera")!=-1){window.location=txt;}else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");}catch(e){alert("您的firefox安全限制限制您进行剪贴板操作，请打开“about:config”将“signed.applets.codebase_principal_support”设置为“true”之后重试");return false;}var clip=Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);if(!clip)return;var trans=Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);if(!trans)return;trans.addDataFlavor('text/unicode');var str=new Object();var len=new Object();var str=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var copytext=txt;str.data=copytext;trans.setTransferData("text/unicode",str,copytext.length*2);var clipid=Components.interfaces.nsIClipboard;if(!clip)return false;clip.setData(trans,null,clipid.kGlobalClipboard);}}if(_copyToClipboard(v)!=false){if(t&&t!="")alert(t);}}
function pxEm(s,p){var a={b:"body",c: false};if(p=="px")a.c=true;var d=(s=="")?0:parseFloat(s);var e;var f=function(){var de=document.documentElement;return self.innerWidth||(de&&de.clientWidth)||document.body.clientWidth;};if(a.b=="body"&&$.browser.msie&&(parseFloat($("body").css("font-size"))/f()).toFixed(1)>0.0){var g=function(){return(parseFloat($("body").css("font-size"))/f()).toFixed(3)*16;};e=g();}else{e=parseFloat(jQuery(a.b).css("font-size"));};var h=(a.c==true)?(d*e).toFixed(2):(d/e).toFixed(2);return h;};
function getRndNum(i,x){if(i==0)x++;return Math.floor((x-i+1)*Math.random()+i);}
function urlAddRndNum(u){if(u.indexOf("?")>=0){return u+"&rnd="+getRndNum(1,99999);}else{return u+"?rnd="+getRndNum(1,99999);}}
function showMD(u,w,h){return window.showModalDialog(urlAddRndNum(u),"myMD_",_returnMDf(w,h));}
function showMDH(u,w,h){return window.showModalDialog(urlAddRndNum(u),"myMD_",__returnMDf(w,h,"no"));}
function cDate(c){t=new Date(c);if(isNaN(t)){var a=c.split(" ")[0];var y=a.split("-")[0];var m=cInt(a.split("-")[1])-1;var d=a.split("-")[2];var h=0,n=0,s=0;if(c.indexOf(":")>=0){var b=c.split(" ")[1];h=b.split(":")[0];n=b.split(":")[1];s=b.split(":")[2];}var t=new Date(Date.parse(new Date(y,m,d,h,n,s)));}return t;}
function dateDiff(t,s,e){var a=cDate(s);var b=cDate(e);var c=b.getTime()-a.getTime();switch(t.toLowerCase()){case "y": return parseInt(b.getFullYear()-a.getFullYear());case "m": return parseInt((b.getFullYear()-a.getFullYear())*12+(b.getMonth()-a.getMonth()));case "d": return parseInt(c/1000/60/60/24);case "w": return parseInt(c/1000/60/60/24/7);case "h": return parseInt(c/1000/60/60);case "n": return parseInt(c/1000/60);case "s": return parseInt(c/1000);case "l": return parseInt(c);}}
function dateAdd(t,n,d){var c=cDate(d);switch(t.toLowerCase()){case "y": return new Date(c.setFullYear(c.getFullYear()+n));case "m": return new Date(c.setMonth(c.getMonth()+n));case "d": return new Date(c.setDate(c.getDate()+n));case "w": return new Date(c.setDate(c.getDate()+7*n));case "h": return new Date(c.setHours(c.getHours()+n));case "n": return new Date(c.setMinutes(c.getMinutes()+n));case "s": return new Date(c.setSeconds(c.getSeconds()+n));case "l": return new Date(c.setMilliseconds(c.getMilliseconds()+n));}}
function formatDateTime(d,t){var c=cDate(d);var y=c.getFullYear();var m=c.getMonth()+1;var d=c.getDate();var h=c.getHours();var n=c.getMinutes();var s=c.getSeconds();var e="";switch(t){case 0:e=y+"-"+m+"-"+d+" "+h+":"+n+":"+s;break;case 1:e=y+"年"+m+"月"+d+"日";break;case 2:e=y+"-"+m+"-"+d;break;case 3:e=h+":"+n+":"+s;break;case 4:e=h+":"+n;break}return e;}
function isDate(d){return !isNaN(cDate(d));}
function getFileExt(i){var f=i.split("?")[0];var a=f.lastIndexOf(".");if(a<0)return "";return f.substring(a+1);}
function getFileName(i){var f=i.split("?")[0];var a=f.lastIndexOf("/");if(a>=0)f=f.substring(a+1);a=f.lastIndexOf("\\");if(a>=0)f=f.substring(a+1);a=f.lastIndexOf(".");if(a<0)return f;return f.substring(0,a);}
function len(s){return s.length;}
function lenCN(s){var l=0;var a=s.split("");for(var i=0;i<a.length;i++){if(a[i].charCodeAt(0)<299){l ++;}else{l+=2;}}return l;}
function isColor(c){if(!isValue(c))return false;if(c.length!=7)return false;return (c.search(/\#[a-fA-F0-9]{6}/)!=-1);}
function imgZoom(o){function _addEvent(o,e,f){if(o.attachEvent){o.attachEvent("on"+e,f)}else{o.addEventListener(e,f,false)}}function _zoomImg(obj,v){var isIE=navigator.userAgent.indexOf("MSIE")>0?true:false;if(isIE){var zoom=parseInt(obj.style.zoom,10)||100;zoom+=v*10;if(zoom>0){obj.style.zoom=zoom+"%"}}else{var minWidth=5;var minHeight=5;var zoomWidth=0;var zoomHeight=0;var step=20;zoomWidth=obj.width+v*step;zoomHeight=obj.height*zoomWidth/obj.width;if(zoomWidth>minWidth&&zoomHeight>minHeight){obj.width=zoomWidth;obj.height=zoomHeight}}}function _wheel(event){var v=0;event=event||window.event;var target=event.target||event.srcElement;if(event.wheelDelta){v=event.wheelDelta/120;if(window.opera){v=-v}}else if(event.detail){v=-event.detail/3}if(v){return _zoomImg(target,v)}}_addEvent($$$(o),"mousewheel",_wheel);_addEvent($$$(o),"DOMMouseScroll",_wheel);}
function writeHomePageAndFavor(o,t,u){if(!isValue(t))t=showPageTitle();if(!isValue(u))u="http://"+getDomain(window.location.href);$(o).html('<a href="#" onclick="_setHomePage(this,\''+u+'\');">设为首页</a> | <a href="#" onclick="_addFavor(\''+t+'\',\''+u+'\');">加入收藏夹</a>')}
function topSetHomeAndFavor(id,hS,fS){var o=$("#"+id);var t=o.attr("title");var u=o.attr("url");if(!isValue(t))t=showPageTitle();if(!isValue(u))u="http://"+getDomain(window.location.href);var f=o.html();if(!isValue(f))f="{0} | {1}";f=f.replace('{0}','<a href="#" onclick="_setHomePage(this,\''+u+'\');">'+hS+'</a>');f=f.replace('{1}','<a href="#" onclick="_addFavor(\''+t+'\',\''+u+'\');">'+fS+'</a>');o.html(f);o.attr("title","");o.attr("url","")}
function isIE(){if($.browser.msie)return true;else return false;}
function showPageTitle(){var t=$("title").html();if(!isValue(t))t=document.title;if(!isValue(t))t="";return t;}
function setTitleStyle(s){var t=showPageTitle();_setTitleStyle(t,s,350,0);}
function changeTitle(s){var t=showPageTitle();_changeTitle(t,s,350,0)}
function FCK_getValue(n){var o=FCKeditorAPI.GetInstance(n);var c=oEditor.GetXHTML();return c}
function FCK_setValue(n,v){var o=FCKeditorAPI.GetInstance(n);o.SetHTML(v)}
function FCK_appendValue(n,v){var o=FCKeditorAPI.GetInstance(n);o.InsertHtml(v)}
function FCK_prependValue(n,v){var o=FCKeditorAPI.GetInstance(n);o.SetHTML(v+FCK_getValue(n))}
function writeCode(o,i,s,c){var w='<input value="" name="'+i+'" id="'+i+'" type="text" class="'+c+'" onclick="if($(\'#'+i+'_img_\').css(\'display\') == \'none\'){_showCodeImg(\''+i+'\',\''+s+'\');}"> <img id="'+i+'_img_" src="" onClick="_reloadImg(\''+i+'_img_\')" style="cursor:pointer;display:none;" alt="点击可刷新验证码" align="absmiddle" /> <font color="#FF0000" id="'+i+'_txt_">←点击框框，出现验证码 *</font>';$("#"+o).html(w);}
function setFont(i){switch(i){case 2:$("body").css("font-family","Arial,Helvetica,sans-serif");break;default:$("body").css("font-family","微软雅黑,新宋体,宋体,Arial,Helvetica,sans-serif");break}}
function selectColor(){return showMD("/js/jquery_selectColor.html",400,330);}
function selectDateA(d){var a=isValue(d)?d:"";return showMDH("/js/jquery_selectDateA.html?d="+a,190,250);}
function mouseXY(ev){var evt=ev||window.event;var mX=evt.clientX;var mY=evt.clientY;return{x:mX,y:mY}}
function bodyWH(){var sH=$("body").height();var sW=$("body").width();return{w:sW,h:sH}}
function clientWH(){var sH=$("html").height();var sW=$("html").width();return{w:sW,h:sH}}
function bodyScrollTL(){var sY,sX;if(typeof window.pageYOffset!='undefined'){sY=window.pageYOffset;sX=window.pageXOffset}else if(typeof document.compatMode!='undefined'&&document.compatMode.toLowerCase()!='backcompat'){sY=document.documentElement.scrollTop;sX=document.documentElement.scrollLeft}else if(typeof document.body!='undefined'){sY=document.body.scrollTop;sX=document.body.scrollLeft}return{l:sX,t:sY}}
function mouseTipsXY(ev){var m=mouseXY(ev);var b=bodyScrollTL();var tX=m.x+b.l;var tY=m.y+b.t;return{x:tX,y:tY}}
function isUrl(u){if(!isValue(u))return false;var l7=lCase(left(u,7));if(l7=="http://"){return true;}return false;}
function isFile(u){if(!isValue(u))return false;var e=lCase(getFileExt(u));if(e.length<=4){if(".html.htm.css.asp.php.aspx.txt.js.jpg.jpeg.gif.bmp".indexOf(e)>0)return true;else return false;}return false;}
function isPic(u){if(!isValue(u))return false;var e=lCase(getFileExt(u));if(e.length<=4){if(".png.jpg.jpeg.gif.bmp".indexOf(e)>0)return true;else return false;}return false;}
function getObjCenterTL(o){var b=bodyScrollTL();var c=clientWH();var h=$(o).height();var w=$(o).width();var t_=b.t+(c.h-h)/2;var l_=b.l+(c.w-w)/2;return{t:t_,l:l_}}
function fillBgWH(){var b=bodyWH();var h_=b.h;var w_=b.w;var c=clientWH();if(c.w>w_)w_=c.w;if(c.h>h_)h_=c.h;return{w:w_,h:h_}}
function showDialogA(t,o,e){this.fullBgJN="#showDialogA-fullbg";this.showBoxJN="#showDialogA-box";this.showContentJN="#showDialogA-content";var trCloseBtnStr='<a onclick="closeBg();" style="cursor:pointer;"><img src="/images/jqueryPublic/transparent.gif" width="20" height="20" border="0" align="absmiddle" alt="close" /></a>';var btnOKStr='<input type="button" name="showDialogA-btnOK" id="showDialogA-btnOK" value=" 确定 " onclick="closeBg();" class="showDialogA-btn" />';var btnConfirmStr='<input type="button" name="showDialogA-btnConfirmOK" id="showDialogA-btnConfirmOK" value=" 确定 " class="showDialogA-btn" onclick="closeBg();" /> &nbsp; <input type="button" name="showDialogA-btnConfirmCancel" id="showDialogA-btnConfirmCancel" value=" 取消 " class="showDialogA-btn" onclick="closeBg();" />';var fullBgHTML='<div id="showDialogA-fullbg"><iframe></iframe></div>';var styleId=1;var style_='<table id="showDialogA-box" class="showDialogA-{styleId}" border="0" cellspacing="0" cellpadding="0"><tr><td id="showDialogA-title">&nbsp;</td><td id="showDialogA-close">&nbsp;</td></tr><tr><td colspan="2" id="showDialogA-content">&nbsp;</td></tr></table>';this.showBg=function(){var b=bodyWH();$(this.fullBgJN).css({width:b.w,height:b.h,display:"block"});var c=getObjCenterTL(this.showBoxJN);$(this.showBoxJN).css({top:c.t,left:c.l,display:"block"});resetBg();$(window).scroll(function(){resetBg()});$(window).resize(function(){resetBg()})};this.resetBg=function(){var fullbg=$(this.fullBgJN).css("display");if(fullbg=="block"){var f=fillBgWH();$(this.fullBgJN).css({width:f.w,height:f.h});var c=getObjCenterTL(this.showBoxJN);$(this.showBoxJN).css({top:c.t,left:c.l})}};this.closeBg=function(){$(this.fullBgJN).css("display","none");$(this.showBoxJN).css("display","none")};this.bindFun=function(){$(this.showContentJN).append('<div id="showDialogA-btnsDiv"></div>');if(e){if(e.btnOK||e.btnOK==""){$("#showDialogA-btnsDiv").html(btnOKStr);if(e.btnOK){$("#showDialogA-btnOK").bind("click",function(){setTimeout(e.btnOK+"()",1)})}}else if(e.btnConfirmOK||e.btnConfirmOK==""){$("#showDialogA-btnsDiv").html(btnConfirmStr);if(e.btnConfirmOK){$("#showDialogA-btnConfirmOK").bind("click",function(){setTimeout(e.btnConfirmOK+"()",1)})}if(e.btnConfirmCancel){$("#showDialogA-btnConfirmCancel").bind("click",function(){setTimeout(e.btnConfirmCancel+"()",1)})}}}};if(!$(this.fullBgJN).attr("id")){$("body").append(fullBgHTML)}if($(this.showBoxJN).attr("id")){$(this.showBoxJN).remove()}if(e){if(e.style){styleId=e.style}else{styleId=1}}else{styleId=1}style_=style_.replace("{styleId}",styleId);$("body").append(style_);this.showBg();$("#showDialogA-close").html(trCloseBtnStr);$("#showDialogA-title").html(t);if(isUrl(o)||isFile(o)){$(this.showContentJN).html("<img src='/images/jqueryPublic/showDialogA_loading.gif' align='absmiddle' />Loading..");$.get(o,function(txt){$(showContentJN).html(txt);bindFun()})}else{$(this.showContentJN).html(o);bindFun()}}
function showRBBox(t,i,e){var o="#rbb_box";var a='<div id="rbb_box" class="{style}"><table width="100%" border="0" cellpadding="0" cellspacing="0" class="tb"><tr><td id="rbb_title">提示信息</td><td class="close"><img src="/images/jqueryPublic/rbBox_close_1.gif" alt="close"/></td></tr><tr><td colspan="2" class="info"><div id="rbb_ibox">&nbsp;</div></td></tr></table></div>';var c=1;if(!$(o).attr("id")){if(e){if(e.style){c=e.style}}a=a.replace("{style}","rbb_box_"+c);$("body").append(a)}if(t){$("#rbb_title").html(t)}if(i){$("#rbb_ibox").html(i)}if(e){if(e.width){$("#rbb_box").css("width",e.width)}}var bW=$(o).width();var bH=$(o).height();function showLT(){var b=clientWH();var s=bodyScrollTL();var left_=b.w+s.l-bW-2;var top_=b.h+s.t-bH-2;$(o).css("left",left_);$(o).css("top",top_)}function close_rbBox(){$(o).fadeOut(500)}$(o).find(".close img").click(close_rbBox);showLT();$(o).fadeIn("slow");$(window).scroll(showLT);if(e){if(e.timeOut){setTimeout(close_rbBox,e.timeOut)}}}
function setTags(o,e){var sId=e.style||1;$(o).addClass("tags_box_"+sId);$(o).find(".tags ul li").eq(0).addClass("on");$(o).css("width",e.width);$(o).find(".tagInfo").css("width",e.width-6*2-2);$(o).find(".tagInfo").css("height",e.height);$(o).find(".bline").css("width",e.width-2);$(o).find(".tags ul li").mouseover(function(){$(o).find(".tags ul li").removeClass();$(this).addClass("on");$(o).find(".tagInfo div[class=tagObj]").css("display","none");$(o).find(".tagInfo div[class=tagObj]").eq($(this).index()).css("display","block")})}
function getFunStr(fun){var l=new String(fun);l=l.substring(l.indexOf("/*")+3,l.lastIndexOf("*/"));return l}
function ipV2(ip){var t=ip.split(".");if(t.length==4){return t[0]+"."+t[1]+".*.*"}else{return ip}}
function isMobile(numstr){var reg=new RegExp("^1[0-9]{10}$");return reg.test(numstr)}
function createFCKeditor(name,toolBarSet,width,height){var oFCKeditor=new FCKeditor(name);oFCKeditor.BasePath=/fckeditor/;oFCKeditor.ToolbarSet=toolBarSet;if(width>0){oFCKeditor.Width=width;}oFCKeditor.Height=height;oFCKeditor.ReplaceTextarea()}
function dblclickSW(){$(document).ready(function(){$(document).mousedown(_clearScrollWindow);$(document).dblclick(_sw_init);});}
function fontZoom(id,size){$("#" + id).css("font-size",size+"px");}
function staticUrlGetPage(){var p = window.location.href;var t = "1";if(p.indexOf("_page") > 0){ t = p.split("_page")[1];t = t.replace(".aspx","");}return t;}
function innerFlashFocus(pics,links,texts,folder,width,height,textHeight,innerObj){var swfHeight = height + textHeight;var flashVars="pics="+pics+"&links="+links+"&texts="+texts+"&borderwidth="+width+"&borderheight="+height+"&textheight="+textHeight;var swfTxt='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="'+width+'" height="'+swfHeight+'">';swfTxt+='<param name="allowScriptAccess" value="sameDomain" />';swfTxt+='<param name="movie" value="/show/'+folder+'/focus.swf" />';swfTxt+='<param name="quality" value="high" />';swfTxt+='<param name="bgcolor" value="#F0F0F0" />';swfTxt+='<param name="menu" value="false" />';swfTxt+='<param name="wmode" value="opaque" />';swfTxt+='<param name="FlashVars" value="'+flashVars+'" />';swfTxt+='<embed src="/show/'+folder+'/focus.swf" wmode="opaque" FlashVars="'+flashVars+'" menu="false" bgcolor="#F0F0F0" quality="high" width="'+width+'" height="'+swfHeight+'" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />';swfTxt+='</object>';$("#"+innerObj).html(swfTxt)}
function innerFlashIndex(pics,links,texts,folder,width,height,innerObj){var flashVars="pics="+pics+"&links="+links+"&texts="+texts;var swfTxt='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="'+width+'" height="'+height+'">';swfTxt+='<param name="allowScriptAccess" value="sameDomain" />';swfTxt+='<param name="movie" value="/show/'+folder+'/index.swf" />';swfTxt+='<param name="quality" value="high" />';swfTxt+='<param name="bgcolor" value="#ffffff" />';swfTxt+='<param name="menu" value="false" />';swfTxt+='<param name="wmode" value="opaque" />';swfTxt+='<param name="FlashVars" value="'+flashVars+'" />';swfTxt+='<embed src="/show/'+folder+'/index.swf" wmode="opaque" FlashVars="'+flashVars+'" menu="false" bgcolor="#ffffff" quality="high" width="'+width+'" height="'+height+'" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />';swfTxt+='</object>';$("#"+innerObj).html(swfTxt)}
function stringFormat(){var numargs=arguments.length;var str="";if(numargs>=1){str=arguments[0];for(var i=1;i<numargs;i++){str=str.replace('{'+(i-1)+'}',arguments[i])}}return str}
function replaceAll(s1,s2,s3){var r=new RegExp(s2.replace(/([\(\)\[\]\{\}\^\$\+\-\*\?\.\"\'\|\/\\])/g,"\\$1"),"ig");return s1.replace(r,s3);}
var strFormat=function(_,B){if(arguments.length>1){var F=strFormat,H=/([.*+?^=!:${}()|[\]\/\\])/g,C=(F.left_delimiter||"{").replace(H,"\\$1"),A=(F.right_delimiter||"}").replace(H,"\\$1"),E=F._r1||(F._r1=new RegExp("#"+C+"([^"+C+A+"]+)"+A,"g")),G=F._r2||(F._r2=new RegExp("#"+C+"(\\d+)"+A,"g"));if(typeof(B)=="object")return _.replace(E,function(_,A){var $=B[A];if(typeof $=="function")$=$(A);return typeof($)=="undefined"?"":$});else if(typeof(B)!="undefined"){var D=Array.prototype.slice.call(arguments,1),$=D.length;return _.replace(G,function(A,_){_=parseInt(_,10);return(_>=$)?A:D[_]})}}return _};
function setSelectMultipleValue(a,v){var b = v.split(",");for(var i = 0;i < b.length;i++){var c = document.getElementById(a);for(var j = 0;j < c.options.length;j++){if(c.options[j].value == b[i]){c.options[j].selected = true;}}}}
var lunarCalendar={LunarDaysOfMonth:new Array(0xd4a8,0xd4a0,0xda50,0x5aa8,0x56a0,0xaad8,0x25d0,0x92d0,0xc958,0xa950,0xb4a0,0xb550,0xb550,0x55a8,0x4ba0,0xa5b0,0x52b8,0x52b0,0xa930,0x74a8,0x6aa0,0xad50,0x4da8,0x4b60,0x9570,0xa4e0,0xd260,0xe930,0xd530,0x5aa0,0x6b50,0x96d0,0x4ae8,0x4ad0,0xa4d0,0xd258,0xd250,0xd520,0xdaa0,0xb5a0,0x56d0,0x4ad8,0x49b0,0xa4b8,0xa4b0,0xaa50,0xb528,0x6d20,0xada0,0x55b0),LunarLeapYear:new Array(0x40,0x02,0x07,0x00,0x50,0x04,0x09,0x00,0x60,0x04,0x00,0x20,0x60,0x05,0x00,0x30,0xb0,0x06,0x00,0x50,0x02,0x07,0x00,0x50,0x03),GetLeapMonth:function(iLunarYear){var Leap=this.LunarLeapYear[(iLunarYear-2001)>>1];return(((iLunarYear-2001)&1)==0)?(Leap>>4):(Leap&0x0f)},LunarMonthDays:function(iLunarYear,iLunarMonth){var High;var Low;var Bit;High=0;Low=29;Bit=16-iLunarMonth;if((iLunarMonth>this.GetLeapMonth(iLunarYear))&&(this.GetLeapMonth(iLunarYear)>0))Bit--;if((this.LunarDaysOfMonth[iLunarYear-2001]&(1<<Bit))>0)Low++;if(iLunarMonth==this.GetLeapMonth(iLunarYear)){High=((this.LunarDaysOfMonth[iLunarYear-2001]&(1<<(Bit-1)))>0)?30:29}return Low+(High<<16)},LunarYearDays:function(iLunarYear){var Days;var tmp;Days=0;for(var i=1;i<=12;i++){tmp=this.LunarMonthDays(iLunarYear,i);Days=Days+((tmp>>16)&0xffff);Days=Days+(tmp&0xffff)}return Days},FormatLunarYear:function(iLunarYear){var szText1=new String("甲乙丙丁戊己庚辛壬癸");var szText2=new String("子丑寅卯辰巳午未申酉戌亥");var strYear;strYear=szText1.substr((iLunarYear-4)%10,1);strYear=strYear+szText2.substr((iLunarYear-4)%12,1);return strYear+"年"},FormatLunarMonth:function(iLunarMonth){var szText=new String("正二三四五六七八九十");var strMonth;if(iLunarMonth<=10){strMonth=szText.substr(iLunarMonth-1,1)}else if(iLunarMonth==11)strMonth="十一";else strMonth="十二";return strMonth+"月"},FormatLunarDay:function(iLunarDay){var szText1=new String("初十廿三");var szText2=new String("一二三四五六七八九十");var strDay;if((iLunarDay!=20)&&(iLunarDay!=30)){strDay=szText1.substr((iLunarDay-1)/10,1)+szText2.substr((iLunarDay-1)%10,1)}else if(iLunarDay!=20){strDay=szText1.substr(iLunarDay/10,1)+"十"}else{strDay="二十"}return strDay},GetLunarDateString:function(SolarDate){var tmp;var iLunarYear;var iLunarMonth;var iLunarDay;var Leap=false;var MinMilli=1000*60;var HrMilli=MinMilli*60;var DyMilli=HrMilli*24;var iSpanDays=Math.round(SolarDate.getTime()/DyMilli)-11323;if(iSpanDays<23){iYear=2000;iLunarMonth=12;iLunarDay=iSpanDays+7}else{iSpanDays=iSpanDays-23;iLunarYear=2001;iLunarMonth=1;iLunarDay=1;tmp=this.LunarYearDays(iLunarYear);while(iSpanDays>=tmp){iSpanDays-=tmp;iLunarYear++;tmp=this.LunarYearDays(iLunarYear)}tmp=this.LunarMonthDays(iLunarYear,iLunarMonth)&0xffff;while(iSpanDays>=tmp){iSpanDays-=tmp;if(iLunarMonth==this.GetLeapMonth(iLunarYear)){tmp=this.LunarMonthDays(iLunarYear,iLunarMonth)>>16;if(iSpanDays<tmp){Leap=(tmp>0)?true:false;break}iSpanDays=iSpanDays-tmp}iLunarMonth++;tmp=this.LunarMonthDays(iLunarYear,iLunarMonth)&0xffff}iLunarDay+=iSpanDays}return this.FormatLunarYear(iLunarYear)+" "+(Leap?"闰":"")+this.FormatLunarMonth(iLunarMonth)+this.FormatLunarDay(iLunarDay)}};
function limitedNumberOfWords(i, m, h, s) { $("#" + i).keyup(function() { limitedNumberOfWords_chk(i, m, h, s) }); limitedNumberOfWords_chk(i, m, h, s) }
function limitedNumberOfWords_chk(i, m, h, s) { var a = cInt($("#" + m).html()); var b = $("#" + i).val().length; var c = a - b; if (c < 0) { c = 0 } var d = a - c; $("#" + h).html(d); $("#" + s).html(c); if (b > a) { $("#" + i).val(left($("#" + i).val(), a)) } }
var idCardNoUtil={provinceAndCitys:{11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"},powers:["7","9","10","5","8","4","2","1","6","3","7","9","10","5","8","4","2"],parityBit:["1","0","X","9","8","7","6","5","4","3","2"],genders:{male:"男",female:"女"},checkAddressCode:function(addressCode){var check=/^[1-9]\d{5}$/.test(addressCode);if(!check)return false;if(idCardNoUtil.provinceAndCitys[parseInt(addressCode.substring(0,2))]){return true}else{return false}},checkBirthDayCode:function(birDayCode){var check=/^[1-9]\d{3}((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1]))$/.test(birDayCode);if(!check)return false;var yyyy=parseInt(birDayCode.substring(0,4),10);var mm=parseInt(birDayCode.substring(4,6),10);var dd=parseInt(birDayCode.substring(6),10);var xdata=new Date(yyyy,mm-1,dd);if(xdata>new Date()){return false}else if((xdata.getFullYear()==yyyy)&&(xdata.getMonth()==mm-1)&&(xdata.getDate()==dd)){return true}else{return false}},getParityBit:function(idCardNo){var id17=idCardNo.substring(0,17);var power=0;for(var i=0;i<17;i++){power+=parseInt(id17.charAt(i),10)*parseInt(idCardNoUtil.powers[i])}var mod=power%11;return idCardNoUtil.parityBit[mod]},checkParityBit:function(idCardNo){var parityBit=idCardNo.charAt(17).toUpperCase();if(idCardNoUtil.getParityBit(idCardNo)==parityBit){return true}else{return false}},isIdCardNo:function(idCardNo){var check=/^\d{15}|(\d{17}(\d|x|X))$/.test(idCardNo);if(!check)return false;if(idCardNo.length==15){return idCardNoUtil.check15IdCardNo(idCardNo)}else if(idCardNo.length==18){return idCardNoUtil.check18IdCardNo(idCardNo)}else{return false}},check15IdCardNo:function(idCardNo){var check=/^[1-9]\d{7}((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1]))\d{3}$/.test(idCardNo);if(!check)return false;var addressCode=idCardNo.substring(0,6);check=idCardNoUtil.checkAddressCode(addressCode);if(!check)return false;var birDayCode='19'+idCardNo.substring(6,12);return idCardNoUtil.checkBirthDayCode(birDayCode)},check18IdCardNo:function(idCardNo){var check=/^[1-9]\d{5}[1-9]\d{3}((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1]))\d{3}(\d|x|X)$/.test(idCardNo);if(!check)return false;var addressCode=idCardNo.substring(0,6);check=idCardNoUtil.checkAddressCode(addressCode);if(!check)return false;var birDayCode=idCardNo.substring(6,14);check=idCardNoUtil.checkBirthDayCode(birDayCode);if(!check)return false;return idCardNoUtil.checkParityBit(idCardNo)},formateDateCN:function(day){var yyyy=day.substring(0,4);var mm=day.substring(4,6);var dd=day.substring(6);return yyyy+'-'+mm+'-'+dd},getIdCardInfo:function(idCardNo){var idCardInfo={gender:"",birthday:""};if(idCardNo.length==15){var aday='19'+idCardNo.substring(6,12);idCardInfo.birthday=idCardNoUtil.formateDateCN(aday);if(parseInt(idCardNo.charAt(14))%2==0){idCardInfo.gender=idCardNoUtil.genders.female}else{idCardInfo.gender=idCardNoUtil.genders.male}}else if(idCardNo.length==18){var aday=idCardNo.substring(6,14);idCardInfo.birthday=idCardNoUtil.formateDateCN(aday);if(parseInt(idCardNo.charAt(16))%2==0){idCardInfo.gender=idCardNoUtil.genders.female}else{idCardInfo.gender=idCardNoUtil.genders.male}}return idCardInfo},getId15:function(idCardNo){if(idCardNo.length==15){return idCardNo}else if(idCardNo.length==18){return idCardNo.substring(0,6)+idCardNo.substring(8,17)}else{return null}},getId18:function(idCardNo){if(idCardNo.length==15){var id17=idCardNo.substring(0,6)+'19'+idCardNo.substring(6);var parityBit=idCardNoUtil.getParityBit(id17);return id17+parityBit}else if(idCardNo.length==18){return idCardNo}else{return null}}};
function ChkInputOnlyNumberOrDP(obj) { var tmp = obj.value.replace(/[^\d.]/g, ""); tmp = tmp.replace(/^\./g, ""); tmp = tmp.replace(/\.{2,}/g, "."); tmp = tmp.replace(".", "$#$").replace(/\./g, "").replace("$#$", "."); obj.value = tmp }
function ChkInputOnlyNumber(obj) { var tmp = obj.value.replace(/[^\d]/g, ""); obj.value = tmp }
function decimal_(num, len) { var temp = Math.pow(10, len); return Math.round(num * temp) / temp }
function SetCheckBoxChecked(jqS, values) { var tempValues = "," + values + ",";$(jqS).each(function() { if (this.checked == false) { if (tempValues.indexOf("," + this.value + ",") >= 0) { this.checked = true; this.disabled = false; } } }) }
function GetCheckBoxCheckedValues(jqS) { var temp = ""; $(jqS).each(function() { if (this.checked == true) { if (temp == "") { temp = this.value } else { temp += "," + this.value } } }); return temp }
var flashMaxCi = 5 * 2; var flashNowCi = 1; var flashSI; function FlashBorder(obj) { if (flashNowCi % 2 == 1) { $(obj).css("border-color", "#ff0000") } if (flashNowCi % 2 == 0) { $(obj).css("border-color", "#ffffff") } flashNowCi++; if (flashNowCi > flashMaxCi) { clearTimeout(flashSI); $(obj).css("border-color", "#ffffff") } } function ShowFlashBorder(jqId, time, num) { flashMaxCi = num * 2; flashNowCi = 1; flashSI = setInterval("FlashBorder('" + jqId + "')", time) }
function TimeAdd(o,t,n){var endTime=$("#"+o).val();var endDate;if(isDate(endTime)){endDate=dateAdd(t,n,endTime);endDate = formatDateTime(endDate, 0); $("#"+o).val(endDate)}else{alert("抱歉，时间格式错误，无法加时！")}}
function AddOptionAt(o, v, t, i) { var userAgent = window.navigator.userAgent; var oo = document.getElementById(o); if (userAgent.indexOf("MSIE") > 0) { var option = document.createElement("option"); option.value = v; option.innerText = t; oo.insertBefore(option, oo.options[i]) } else { oo.insertBefore(new Option(v, t), oo.options[i]) } }
function RemoveHTML(str) {var temp = str.replace(/<.+?>/g,'');return temp;}

function _returnMDf(w,h){return __returnMDf(w,h,"yes");}
function __returnMDf(w,h,s){var x=window.screen.width/2-w/2;var y=window.screen.height/2-h/2;var n=w+4+18;var f="dialogWidth:"+n+"px;dialogHeight:"+h+"px;dialogLeft:"+x+"px;dialogTop:"+y+"px;directories:no; localtion:no; menubar:no; status=no; toolbar=no;scrollbars:"+s+";Resizeable=no";return f}
function _addFavor(t,u){if(document.all)window.external.AddFavorite(u,t);else if(window.sidebar)window.sidebar.addPanel(t,u,"");else alert("您的浏览器不支持自动添加，请手动添加到收藏夹！");}
function _setHomePage(o,u){if(document.all){o.style.behavior="url(#default#homepage)";o.setHomePage(u);}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");}catch(e){alert("您的firefox安全限制限制您设为首页操作，请打开“about:config”将“signed.applets.codebase_principal_support”设置为“true”之后重试");}}var prefs=Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefBranch);prefs.setCharPref("browser.startup.homepage",u);}}
function _setTitleStyle(t,s,o,i){var a="◆",b="◇";switch(s){case 2:a="★",b="☆";break;case 3:a="●",b="○";break;case 4:a="◆",b="◇";break;case 5:a="■",b="□";break;case 6:a="▲",b="△";break;}i++;if(i>=5){i=1}if(i==1){document.title=a+b+b+t}if(i==2){document.title=b+a+b+t}if(i==3){document.title=b+b+a+t}if(i==4){document.title=b+a+b+t}setTimeout("_setTitleStyle('"+t+"',"+s+","+o+","+i+")",o)}
function _changeTitle(t,s,o,i){i++;if(s.length<=8){if(i>=3){i=1}if(i==1){var d=s;document.title="【"+d+"】"+t}if(i==2){var e=s.length;var f="";for(var j=1;j<=e;j++){f+="　"}document.title="【"+f+"】"+t}}else{if(i>s.length){i=1}var a=i-1;var b=a+8;var c=s.substring(a,b);if(c.length<8){c+=s.substring(0,8-c.length)}document.title="〖"+c+"〗"+t}setTimeout("_changeTitle('"+t+"','"+s+"',"+o+","+i+")",o)}
function _showCodeImg(o,s){var t=$("#"+o+"_txt_");var i=$("#"+o+"_img_");t.html("←看不清？点击图片可刷新 *");i.css("display","inline");i.attr("src",urlAddRndNum(s));}
function _reloadImg(i){var o=$("#"+i);o.attr("src",urlAddRndNum(o.attr("src")));}
var _sw_timer;function _sw_init(){_sw_timer=setInterval("_scrollWindowDo()",30)}function _clearScrollWindow(){clearInterval(_sw_timer)}function _scrollWindowDo(){var currentpos=document.documentElement.scrollTop;window.scroll(0,++currentpos);if(currentpos!=document.documentElement.scrollTop)_clearScrollWindow()}
$.include=function(urls,finaly){var luid=$.include.luid++;var onload=function(callback,data){if($.isFunction(callback)){callback(data)}if(--$.include.counter[luid]==0&&$.isFunction(finaly)){finaly()}};if(typeof urls=="object"&&typeof urls.length=="undefined"){$.include.counter[luid]=0;for(var item in urls){$.include.counter[luid]++}return $.each(urls,function(url,callback){$.include.load(url,onload,callback)})}urls=$.makeArray(urls);$.include.counter[luid]=urls.length;$.each(urls,function(){$.include.load(this,onload,null)})};$.extend($.include,{luid:0,counter:[],load:function(url,onload,callback){url=url.toString();if($.include.exist(url)){return onload(callback)}if(/.css$/.test(url)){$.include.loadCSS(url,onload,callback)}else{if(/.js$/.test(url)){$.include.loadJS(url,onload,callback)}else{$.get(url,function(data){onload(callback,data)})}}},loadCSS:function(url,onload,callback){var css=document.createElement("link");css.setAttribute("type","text/css");css.setAttribute("rel","stylesheet");css.setAttribute("href",""+url);$("head").get(0).appendChild(css);$.browser.msie?$.include.IEonload(css,onload,callback):onload(callback)},loadJS:function(url,onload,callback){var js=document.createElement("script");js.setAttribute("type","text/javascript");js.setAttribute("src",""+url);$.browser.msie?$.include.IEonload(js,onload,callback):js.onload=function(){onload(callback)};$("head").get(0).appendChild(js)},IEonload:function(elm,onload,callback){elm.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){onload(callback)}}},exist:function(url){var fresh=false;$("head script").each(function(){if(/.css$/.test(url)&&this.href==url){return fresh=true}else{if(/.js$/.test(url)&&this.src==url){return fresh=true}}});return fresh}})
$.cookie=function(n,v,o){if(typeof v!='undefined'){o=o||{};if(v===null){v='';o.expires=-1}var expires='';if(o.expires&&(typeof o.expires=='number'||o.expires.toUTCString)){var date;if(typeof o.expires=='number'){date=new Date();date.setTime(date.getTime()+(o.expires*24*60*60*1000))}else{date=o.expires}expires='; expires='+date.toUTCString()}var path=o.path?'; path='+(o.path):'';var domain=o.domain?'; domain='+(o.domain):'';var secure=o.secure?'; secure':'';document.cookie=[n,'=',encodeURIComponent(v),expires,path,domain,secure].join('')}else{var cookiev=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,n.length+1)==(n+'=')){cookiev=decodeURIComponent(cookie.substring(n.length+1));break}}}return cookiev}};
(function($) { $.cluetip = { version: '1.0.6' }; var $cluetip, $cluetipInner, $cluetipOuter, $cluetipTitle, $cluetipArrows, $cluetipWait, $dropShadow, imgCount; $.fn.cluetip = function(js, options) { if (typeof js == 'object') { options = js; js = null } if (js == 'destroy') { return this.removeData('thisInfo').unbind('.cluetip') } return this.each(function(index) { var link = this, $this = $(this); var opts = $.extend(true, {}, $.fn.cluetip.defaults, options || {}, $.metadata ? $this.metadata() : $.meta ? $this.data() : {}); var cluetipContents = false; var cluezIndex = +opts.cluezIndex; $this.data('thisInfo', { title: link.title, zIndex: cluezIndex }); var isActive = false, closeOnDelay = 0; if (!$('#cluetip').length) { $(['<div id="cluetip">', '<div id="cluetip-outer">', '<h3 id="cluetip-title"></h3>', '<div id="cluetip-inner"></div>', '</div>', '<div id="cluetip-extra"></div>', '<div id="cluetip-arrows" class="cluetip-arrows"></div>', '</div>'].join(''))[insertionType](insertionElement).hide(); $cluetip = $('#cluetip').css({ position: 'absolute' }); $cluetipOuter = $('#cluetip-outer').css({ position: 'relative', zIndex: cluezIndex }); $cluetipInner = $('#cluetip-inner'); $cluetipTitle = $('#cluetip-title'); $cluetipArrows = $('#cluetip-arrows'); $cluetipWait = $('<div id="cluetip-waitimage"></div>').css({ position: 'absolute' }).insertBefore($cluetip).hide() } var dropShadowSteps = (opts.dropShadow) ? +opts.dropShadowSteps : 0; if (!$dropShadow) { $dropShadow = $([]); for (var i = 0; i < dropShadowSteps; i++) { $dropShadow = $dropShadow.add($('<div></div>').css({ zIndex: cluezIndex - 1, opacity: .1, top: 1 + i, left: 1 + i })) } $dropShadow.css({ position: 'absolute', backgroundColor: '#000' }).prependTo($cluetip) } var tipAttribute = $this.attr(opts.attribute), ctClass = opts.cluetipClass; if (!tipAttribute && !opts.splitTitle && !js) { return true } if (opts.local && opts.localPrefix) { tipAttribute = opts.localPrefix + tipAttribute } if (opts.local && opts.hideLocal) { $(tipAttribute + ':first').hide() } var tOffset = parseInt(opts.topOffset, 10), lOffset = parseInt(opts.leftOffset, 10); var tipHeight, wHeight, defHeight = isNaN(parseInt(opts.height, 10)) ? 'auto' : (/\D/g).test(opts.height) ? opts.height : opts.height + 'px'; var sTop, linkTop, posY, tipY, mouseY, baseline; var tipInnerWidth = parseInt(opts.width, 10) || 275, tipWidth = tipInnerWidth + (parseInt($cluetip.css('paddingLeft'), 10) || 0) + (parseInt($cluetip.css('paddingRight'), 10) || 0) + dropShadowSteps, linkWidth = this.offsetWidth, linkLeft, posX, tipX, mouseX, winWidth; var tipParts; var tipTitle = (opts.attribute != 'title') ? $this.attr(opts.titleAttribute) : ''; if (opts.splitTitle) { if (tipTitle == undefined) { tipTitle = '' } tipParts = tipTitle.split(opts.splitTitle); tipTitle = tipParts.shift() } if (opts.escapeTitle) { tipTitle = tipTitle.replace(/&/g, '&amp;').replace(/>/g, '&gt;').replace(/</g, '&lt;') } var localContent; function returnFalse() { return false } function css_showNewInfo(o) { var t = css_showInputValue(o); t = t.replace(/\[/g, "<"); t = t.replace(/\]/g, ">"); t = t.replace(/<img /g, "<img style=\"width:250px;\" height=\"34\" onerror=\"this.src='/images/jqueryPublic/imgLoadError.gif'\" "); return t } function css_showInputValue(str) { var reg = /\[imgInputId=.*?\]/g; var arr = str.match(reg); var temp = str; try { for (var i = 0; i < arr.length; i++) { var o = arr[i].replace("[imgInputId=", "").replace("]", ""); temp = temp.replace(arr[i], "[img src='" + $("#" + o).val() + "']") } } catch (e) { temp = str } return temp } var activate = function(event) { if (!opts.onActivate($this)) { return false } isActive = true; $cluetip.removeClass().css({ width: tipInnerWidth }); if (tipAttribute == $this.attr('href')) { $this.css('cursor', opts.cursor) } if (opts.hoverClass) { $this.addClass(opts.hoverClass) } linkTop = posY = $this.offset().top; linkLeft = $this.offset().left; mouseX = event.pageX; mouseY = event.pageY; if (link.tagName.toLowerCase() != 'area') { sTop = $(document).scrollTop(); winWidth = $(window).width() } if (opts.positionBy == 'fixed') { posX = linkWidth + linkLeft + lOffset; $cluetip.css({ left: posX }) } else { posX = (linkWidth > linkLeft && linkLeft > tipWidth) || linkLeft + linkWidth + tipWidth + lOffset > winWidth ? linkLeft - tipWidth - lOffset : linkWidth + linkLeft + lOffset; if (link.tagName.toLowerCase() == 'area' || opts.positionBy == 'mouse' || linkWidth + tipWidth > winWidth) { if (mouseX + 20 + tipWidth > winWidth) { $cluetip.addClass(' cluetip-' + ctClass); posX = (mouseX - tipWidth - lOffset) >= 0 ? mouseX - tipWidth - lOffset - parseInt($cluetip.css('marginLeft'), 10) + parseInt($cluetipInner.css('marginRight'), 10) : mouseX - (tipWidth / 2) } else { posX = mouseX + lOffset } } var pY = posX < 0 ? event.pageY + tOffset : event.pageY; $cluetip.css({ left: (posX > 0 && opts.positionBy != 'bottomTop') ? posX : (mouseX + (tipWidth / 2) > winWidth) ? winWidth / 2 - tipWidth / 2 : Math.max(mouseX - (tipWidth / 2), 0), zIndex: $this.data('thisInfo').zIndex }); $cluetipArrows.css({ zIndex: $this.data('thisInfo').zIndex + 1 }) } wHeight = $(window).height(); if (js) { if (typeof js == 'function') { js = js.call(link) } $cluetipInner.html(js); cluetipShow(pY) } else if (tipParts) { var tpl = tipParts.length; $cluetipInner.html(tpl ? css_showNewInfo(tipParts[0]) : ''); if (tpl > 1) { for (var i = 1; i < tpl; i++) { $cluetipInner.append('<div class="split-body">' + css_showNewInfo(tipParts[i]) + '</div>') } } cluetipShow(pY) } else if (!opts.local && tipAttribute.indexOf('#') !== 0) { if (/\.(jpe?g|tiff?|gif|png)$/i.test(tipAttribute)) { $cluetipInner.html('<img src="' + tipAttribute + '" alt="' + tipTitle + '" />'); cluetipShow(pY) } else if (cluetipContents && opts.ajaxCache) { $cluetipInner.html(cluetipContents); cluetipShow(pY) } else { var optionBeforeSend = opts.ajaxSettings.beforeSend, optionError = opts.ajaxSettings.error, optionSuccess = opts.ajaxSettings.success, optionComplete = opts.ajaxSettings.complete; var ajaxSettings = { cache: false, url: tipAttribute, beforeSend: function(xhr) { if (optionBeforeSend) { optionBeforeSend.call(link, xhr, $cluetip, $cluetipInner) } $cluetipOuter.children().empty(); if (opts.waitImage) { $cluetipWait.css({ top: mouseY + 20, left: mouseX + 20, zIndex: $this.data('thisInfo').zIndex - 1 }).show() } }, error: function(xhr, textStatus) { if (isActive) { if (optionError) { optionError.call(link, xhr, textStatus, $cluetip, $cluetipInner) } else { $cluetipInner.html('<i>sorry, the contents could not be loaded</i>') } } }, success: function(data, textStatus) { cluetipContents = opts.ajaxProcess.call(link, data); if (isActive) { if (optionSuccess) { optionSuccess.call(link, data, textStatus, $cluetip, $cluetipInner) } $cluetipInner.html(cluetipContents) } }, complete: function(xhr, textStatus) { if (optionComplete) { optionComplete.call(link, xhr, textStatus, $cluetip, $cluetipInner) } var imgs = $cluetipInner[0].getElementsByTagName('img'); imgCount = imgs.length; for (var i = 0, l = imgs.length; i < l; i++) { if (imgs[i].complete) { imgCount-- } } if (imgCount && !$.browser.opera) { $(imgs).bind('load error', function() { imgCount--; if (imgCount < 1) { $cluetipWait.hide(); if (isActive) { cluetipShow(pY) } } }) } else { $cluetipWait.hide(); if (isActive) { cluetipShow(pY) } } } }; var ajaxMergedSettings = $.extend(true, {}, opts.ajaxSettings, ajaxSettings); $.ajax(ajaxMergedSettings) } } else if (opts.local) { var $localContent = $(tipAttribute + (/#\S+$/.test(tipAttribute) ? '' : ':eq(' + index + ')')).clone(true).show(); $cluetipInner.html($localContent); cluetipShow(pY) } }; var cluetipShow = function(bpY) { $cluetip.addClass('cluetip-' + ctClass); if (opts.truncate) { var $truncloaded = $cluetipInner.text().slice(0, opts.truncate) + '...'; $cluetipInner.html($truncloaded) } function doNothing() { }; tipTitle ? $cluetipTitle.show().html(tipTitle) : (opts.showTitle) ? $cluetipTitle.show().html('&nbsp;') : $cluetipTitle.hide(); if (opts.sticky) { var $closeLink = $('<div id="cluetip-close"><a href="#">' + opts.closeText + '</a></div>'); (opts.closePosition == 'bottom') ? $closeLink.appendTo($cluetipInner) : (opts.closePosition == 'title') ? $closeLink.prependTo($cluetipTitle) : $closeLink.prependTo($cluetipInner); $closeLink.bind('click.cluetip', function() { cluetipClose(); return false }); if (opts.mouseOutClose) { $cluetip.bind('mouseleave.cluetip', function() { cluetipClose() }) } else { $cluetip.unbind('mouseleave.cluetip') } } var direction = ''; $cluetipOuter.css({ zIndex: $this.data('thisInfo').zIndex, overflow: defHeight == 'auto' ? 'visible' : 'auto', height: defHeight }); tipHeight = defHeight == 'auto' ? Math.max($cluetip.outerHeight(), $cluetip.height()) : parseInt(defHeight, 10); tipY = posY; baseline = sTop + wHeight; if (opts.positionBy == 'fixed') { tipY = posY - opts.dropShadowSteps + tOffset } else if ((posX < mouseX && Math.max(posX, 0) + tipWidth > mouseX) || opts.positionBy == 'bottomTop') { if (posY + tipHeight + tOffset > baseline && mouseY - sTop > tipHeight + tOffset) { tipY = mouseY - tipHeight - tOffset; direction = 'top' } else { tipY = mouseY + tOffset; direction = 'bottom' } } else if (posY + tipHeight + tOffset > baseline) { tipY = (tipHeight >= wHeight) ? sTop : baseline - tipHeight - tOffset } else if ($this.css('display') == 'block' || link.tagName.toLowerCase() == 'area' || opts.positionBy == "mouse") { tipY = bpY - tOffset } else { tipY = posY - opts.dropShadowSteps } if (direction == '') { posX < linkLeft ? direction = 'left' : direction = 'right' } $cluetip.css({ top: tipY + 'px' }).removeClass().addClass('clue-' + direction + '-' + ctClass).addClass(' cluetip-' + ctClass); if (opts.arrows) { var bgY = (posY - tipY - opts.dropShadowSteps); $cluetipArrows.css({ top: (/(left|right)/.test(direction) && posX >= 0 && bgY > 0) ? bgY + 'px' : /(left|right)/.test(direction) ? 0 : '' }).show() } else { $cluetipArrows.hide() } $dropShadow.hide(); $cluetip.hide()[opts.fx.open](opts.fx.openSpeed || 0); if (opts.dropShadow) { $dropShadow.css({ height: tipHeight, width: tipInnerWidth, zIndex: $this.data('thisInfo').zIndex - 1 }).show() } if ($.fn.bgiframe) { $cluetip.bgiframe() } if (opts.delayedClose > 0) { closeOnDelay = setTimeout(cluetipClose, opts.delayedClose) } opts.onShow.call(link, $cluetip, $cluetipInner) }; var inactivate = function(event) { isActive = false; $cluetipWait.hide(); if (!opts.sticky || (/click|toggle/).test(opts.activation)) { cluetipClose(); clearTimeout(closeOnDelay) } if (opts.hoverClass) { $this.removeClass(opts.hoverClass) } }; var cluetipClose = function() { $cluetipOuter.parent().hide().removeClass(); opts.onHide.call(link, $cluetip, $cluetipInner); $this.removeClass('cluetip-clicked'); if (tipTitle) { $this.attr(opts.titleAttribute, tipTitle) } $this.css('cursor', ''); if (opts.arrows) { $cluetipArrows.css({ top: '' }) } }; $(document).bind('hideCluetip', function(e) { cluetipClose() }); if ((/click|toggle/).test(opts.activation)) { $this.bind('click.cluetip', function(event) { if ($cluetip.is(':hidden') || !$this.is('.cluetip-clicked')) { activate(event); $('.cluetip-clicked').removeClass('cluetip-clicked'); $this.addClass('cluetip-clicked') } else { inactivate(event) } this.blur(); return false }) } else if (opts.activation == 'focus') { $this.bind('focus.cluetip', function(event) { activate(event) }); $this.bind('blur.cluetip', function(event) { inactivate(event) }) } else { $this[opts.clickThrough ? 'unbind' : 'bind']('click', returnFalse); var mouseTracks = function(evt) { if (opts.tracking == true) { var trackX = posX - evt.pageX; var trackY = tipY ? tipY - evt.pageY : posY - evt.pageY; $this.bind('mousemove.cluetip', function(evt) { $cluetip.css({ left: evt.pageX + trackX, top: evt.pageY + trackY }) }) } }; if ($.fn.hoverIntent && opts.hoverIntent) { $this.hoverIntent({ sensitivity: opts.hoverIntent.sensitivity, interval: opts.hoverIntent.interval, over: function(event) { activate(event); mouseTracks(event) }, timeout: opts.hoverIntent.timeout, out: function(event) { inactivate(event); $this.unbind('mousemove.cluetip') } }) } else { $this.bind('mouseenter.cluetip', function(event) { activate(event); mouseTracks(event) }).bind('mouseleave.cluetip', function(event) { inactivate(event); $this.unbind('mousemove.cluetip') }) } $this.bind('mouseover.cluetip', function(event) { $this.attr('title', '') }).bind('mouseleave.cluetip', function(event) { $this.attr('title', $this.data('thisInfo').title) }) } }) }; $.fn.cluetip.defaults = { width: 275, height: 'auto', cluezIndex: 97, positionBy: 'auto', topOffset: 15, leftOffset: 15, local: false, localPrefix: null, hideLocal: true, attribute: 'rel', titleAttribute: 'title', splitTitle: '', escapeTitle: false, showTitle: true, cluetipClass: 'default', hoverClass: '', waitImage: true, cursor: 'help', arrows: false, dropShadow: true, dropShadowSteps: 6, sticky: false, mouseOutClose: false, activation: 'hover', clickThrough: true, tracking: false, delayedClose: 0, closePosition: 'top', closeText: '[×关闭]', truncate: 0, fx: { open: 'show', openSpeed: '' }, hoverIntent: { sensitivity: 3, interval: 50, timeout: 0 }, onActivate: function(e) { return true }, onShow: function(ct, ci) { }, onHide: function(ct, ci) { }, ajaxCache: true, ajaxProcess: function(data) { data = data.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm, '').replace(/<(link|meta)[^>]+>/g, ''); return data }, ajaxSettings: { dataType: 'html' }, debug: false }; var insertionType = 'appendTo', insertionElement = 'body'; $.cluetip.setup = function(options) { if (options && options.insertionType && (options.insertionType).match(/appendTo|prependTo|insertBefore|insertAfter/)) { insertionType = options.insertionType } if (options && options.insertionElement) { insertionElement = options.insertionElement } } })(jQuery);
(function($){$.fn.drag=function(fn1,fn2,fn3){if(fn2)this.bind('dragstart',fn1);if(fn3)this.bind('dragend',fn3);return!fn1?this.trigger('drag'):this.bind('drag',fn2?fn2:fn1)};var drag=$.event.special.drag={not:':input',distance:0,which:1,dragging:false,setup:function(data){data=$.extend({distance:drag.distance,which:drag.which,not:drag.not},data||{});data.distance=drag_squared(data.distance);$.event.add(this,"mousedown",drag_handler,data);if(this.attachEvent)this.attachEvent("ondragstart",drag_dontStart)},teardown:function(){$.event.remove(this,"mousedown",drag_handler);if(this===drag.dragging)drag.dragging=drag.proxy=false;drag_selectable(this,true);if(this.detachEvent)this.detachEvent("ondragstart",drag_dontStart)}};$.event.special.dragstart=$.event.special.dragend={setup:function(){},teardown:function(){}};function drag_handler(event){var elem=this,returned,data=event.data||{};if(data.elem){elem=event.dragTarget=data.elem;event.dragProxy=drag.proxy||elem;event.cursorOffsetX=data.pageX-data.left;event.cursorOffsetY=data.pageY-data.top;event.offsetX=event.pageX-event.cursorOffsetX;event.offsetY=event.pageY-event.cursorOffsetY}else if(drag.dragging||(data.which>0&&event.which!=data.which)||$(event.target).is(data.not))return;switch(event.type){case'mousedown':$.extend(data,$(elem).offset(),{elem:elem,target:event.target,pageX:event.pageX,pageY:event.pageY});$.event.add(document,"mousemove mouseup",drag_handler,data);drag_selectable(elem,false);drag.dragging=null;return false;case!drag.dragging&&'mousemove':if(drag_squared(event.pageX-data.pageX)+drag_squared(event.pageY-data.pageY)<data.distance)break;event.target=data.target;returned=drag_hijack(event,"dragstart",elem);if(returned!==false){drag.dragging=elem;drag.proxy=event.dragProxy=$(returned||elem)[0]}case'mousemove':if(drag.dragging){returned=drag_hijack(event,"drag",elem);if($.event.special.drop){$.event.special.drop.allowed=(returned!==false);$.event.special.drop.drag_handler(event)}if(returned!==false)break;event.type="mouseup"}case'mouseup':$.event.remove(document,"mousemove mouseup",drag_handler);if(drag.dragging){if($.event.special.drop)$.event.special.drop.drag_handler(event);drag_hijack(event,"dragend",elem)}drag_selectable(elem,true);drag.dragging=drag.proxy=data.elem=false;break}return true};function drag_hijack(event,type,elem){event.type=type;var result=$.event.handle.call(elem,event);return result===false?false:result||event.result};function drag_squared(value){return Math.pow(value,2)};function drag_dontStart(){return(drag.dragging===false)};function drag_selectable(elem,bool){if(!elem)return;elem.undrag_selectable=bool?"off":"on";elem.onselectstart=function(){return bool};if(elem.style)elem.style.MozUserSelect=bool?"":"none"}})(jQuery);
function tb_init(b,o){$(b).click(function(){var t=this.title||this.name||null;var a=this.href||this.alt;var g=this.rel||false;tb_show(t,a,g,o);this.blur();return false})}function tb_show(d,f,g,ofh){try{if(typeof document.body.style.maxHeight==="undefined"){$("body","html").css({height:"100%",width:"100%"});$("html").css("overflow","hidden");if(document.getElementById("TB_HideSelect")===null){$("body").append("<iframe id='TB_HideSelect'></iframe><div id='TB_overlay'></div><div id='TB_window'></div>");$("#TB_overlay").click(tb_remove)}}else{if(document.getElementById("TB_overlay")===null){$("body").append("<div id='TB_overlay'></div><div id='TB_window'></div>");$("#TB_overlay").click(tb_remove)}}if(tb_detectMacXFF()){$("#TB_overlay").addClass("TB_overlayMacFFBGHack")}else{$("#TB_overlay").addClass("TB_overlayBG")}if(d===null){d=""}$("body").append("<div id='TB_load'><img src='"+tb_imgLoader.src+"' /></div>");$('#TB_load').show();var h;if(f.indexOf("?")!==-1){h=f.substr(0,f.indexOf("?"))}else{h=f}var i=/\.jpg$|\.jpeg$|\.png$|\.gif$|\.bmp$/;var j=h.toLowerCase().match(i);if(j=='.jpg'||j=='.jpeg'||j=='.png'||j=='.gif'||j=='.bmp'){TB_PrevCaption="";TB_PrevURL="";TB_PrevHTML="";TB_NextCaption="";TB_NextURL="";TB_NextHTML="";TB_imageCount="";TB_FoundURL=false;if(g){TB_TempArray=$("a[rel="+g+"]").get();for(TB_Counter=0;((TB_Counter<TB_TempArray.length)&&(TB_NextHTML===""));TB_Counter++){var k=TB_TempArray[TB_Counter].href.toLowerCase().match(i);if(!(TB_TempArray[TB_Counter].href==f)){if(TB_FoundURL){TB_NextCaption=TB_TempArray[TB_Counter].title;TB_NextURL=TB_TempArray[TB_Counter].href;TB_NextHTML="<span id='TB_next'>&nbsp;&nbsp;<a href='#'>Next &gt;</a></span>"}else{TB_PrevCaption=TB_TempArray[TB_Counter].title;TB_PrevURL=TB_TempArray[TB_Counter].href;TB_PrevHTML="<span id='TB_prev'>&nbsp;&nbsp;<a href='#'>&lt; Prev</a></span>"}}else{TB_FoundURL=true;TB_imageCount="Image "+(TB_Counter+1)+" of "+(TB_TempArray.length)}}}imgPreloader=new Image();imgPreloader.onload=function(){imgPreloader.onload=null;var a=tb_getPageSize();var x=a[0]-150;var y=a[1]-150;var b=imgPreloader.width;var c=imgPreloader.height;if(b>x){c=c*(x/b);b=x;if(c>y){b=b*(y/c);c=y}}else if(c>y){b=b*(y/c);c=y;if(b>x){c=c*(x/b);b=x}}TB_WIDTH=b+30;TB_HEIGHT=c+60;$("#TB_window").append("<a href='' id='TB_ImageOff' title='Close'><img id='TB_Image' src='"+f+"' width='"+b+"' height='"+c+"' alt='"+d+"'/></a><div id='TB_caption'>"+d+"<div id='TB_secondLine'>"+TB_imageCount+TB_PrevHTML+TB_NextHTML+"</div></div><div id='TB_closeWindow'><a href='#' id='TB_closeWindowButton' title='Close'><img src='/images/jqueryPublic/tb_close.gif' width='13' height='14' border='0' align='absmiddle' /></a></div>");$("#TB_closeWindowButton").click(tb_remove);if(!(TB_PrevHTML==="")){function goPrev(){if($(document).unbind("click",goPrev)){$(document).unbind("click",goPrev)}$("#TB_window").remove();$("body").append("<div id='TB_window'></div>");tb_show(TB_PrevCaption,TB_PrevURL,g);return false}$("#TB_prev").click(goPrev)}if(!(TB_NextHTML==="")){function goNext(){$("#TB_window").remove();$("body").append("<div id='TB_window'></div>");tb_show(TB_NextCaption,TB_NextURL,g);return false}$("#TB_next").click(goNext)}tb_position();$("#TB_load").remove();$("#TB_ImageOff").click(tb_remove);$("#TB_window").css({display:"block"})};imgPreloader.src=f}else{var l=f.replace(/^[^\?]+\??/,'');var m=tb_parseQuery(l);TB_WIDTH=(m['width']*1)+30||630;TB_HEIGHT=(m['height']*1)+40||440;ajaxContentW=TB_WIDTH-30;ajaxContentH=TB_HEIGHT-45;if(f.indexOf('TB_iframe')!=-1){urlNoQuery=f.split('TB_');$("#TB_iframeContent").remove();if(m['modal']!="true"){$("#TB_window").append("<div id='TB_title'><div id='TB_ajaxWindowTitle'>"+d+"</div><div id='TB_closeAjaxWindow'><a href='#' id='TB_closeWindowButton' title='Close'><img src='/images/jqueryPublic/tb_close.gif' width='13' height='14' border='0' align='absmiddle' /></a></div></div><iframe frameborder='0' hspace='0' "+(ofh?' scrolling="no"':'')+" src='"+urlNoQuery[0]+"' id='TB_iframeContent' name='TB_iframeContent"+Math.round(Math.random()*1000)+"' onload='tb_showIframe()' style='width:"+(ajaxContentW+29)+"px;height:"+(ajaxContentH+17)+"px;' > </iframe>")}else{$("#TB_overlay").unbind();$("#TB_window").append("<iframe frameborder='0' hspace='0' "+(ofh?' scrolling="no"':'')+" src='"+urlNoQuery[0]+"' id='TB_iframeContent' name='TB_iframeContent"+Math.round(Math.random()*1000)+"' onload='tb_showIframe()' style='width:"+(ajaxContentW+29)+"px;height:"+(ajaxContentH+17)+"px;'> </iframe>")}}else{if($("#TB_window").css("display")!="block"){if(m['modal']!="true"){$("#TB_window").append("<div id='TB_title'><div id='TB_ajaxWindowTitle'>"+d+"</div><div id='TB_closeAjaxWindow'><a href='#' id='TB_closeWindowButton'><img src='/images/jqueryPublic/tb_close.gif' width='13' height='14' border='0' align='absmiddle' /></a></div></div><div id='TB_ajaxContent' style='width:"+ajaxContentW+"px;height:"+ajaxContentH+"px'></div>")}else{$("#TB_overlay").unbind();$("#TB_window").append("<div id='TB_ajaxContent' class='TB_modal' style='width:"+ajaxContentW+"px;height:"+ajaxContentH+"px;'></div>")}}else{$("#TB_ajaxContent")[0].style.width=ajaxContentW+"px";$("#TB_ajaxContent")[0].style.height=ajaxContentH+"px";$("#TB_ajaxContent")[0].scrollTop=0;$("#TB_ajaxWindowTitle").html(d)}}$("#TB_closeWindowButton").click(tb_remove);if(f.indexOf('TB_inline')!=-1){$("#TB_ajaxContent").append($('#'+m['inlineId']).html());tb_position();$("#TB_load").remove();$("#TB_window").css({display:"block"})}else if(f.indexOf('TB_iframe')!=-1){tb_position();if($.browser.safari){$("#TB_load").remove();$("#TB_window").css({display:"block"})}}else{$("#TB_ajaxContent").load(f+="&random="+(new Date().getTime()),function(){tb_position();$("#TB_load").remove();tb_init("#TB_ajaxContent a.thickbox");$("#TB_window").css({display:"block"})})}}if(!m['modal']){document.onkeyup=function(e){if(e==null){keycode=event.keyCode}else{keycode=e.which}if(keycode==27){tb_remove()}}}}catch(e){}}function tb_showIframe(){$("#TB_load").remove();$("#TB_window").css({display:"block"})}function tb_remove(){$("#TB_imageOff").unbind("click");$("#TB_closeWindowButton").unbind("click");$("#TB_window").fadeOut("fast",function(){$('#TB_window,#TB_overlay,#TB_HideSelect').trigger("unload").unbind().remove()});$("#TB_load").remove();if(typeof document.body.style.maxHeight=="undefined"){$("body","html").css({height:"auto",width:"auto"});$("html").css("overflow","")}document.onkeydown="";document.onkeyup="";return false}function tb_position(){$("#TB_window").css({marginLeft:'-'+parseInt((TB_WIDTH/2),10)+'px',width:TB_WIDTH+'px'});if(!(jQuery.browser.msie&&jQuery.browser.version<7)){$("#TB_window").css({marginTop:'-'+parseInt((TB_HEIGHT/2),10)+'px'})}}function tb_parseQuery(a){var b={};if(!a){return b}var c=a.split(/[;&]/);for(var i=0;i<c.length;i++){var d=c[i].split('=');if(!d||d.length!=2){continue}var e=unescape(d[0]);var f=unescape(d[1]);f=f.replace(/\+/g,' ');b[e]=f}return b}function tb_getPageSize(){var a=document.documentElement;var w=window.innerWidth||self.innerWidth||(a&&a.clientWidth)||document.body.clientWidth;var h=window.innerHeight||self.innerHeight||(a&&a.clientHeight)||document.body.clientHeight;arrayPageSize=[w,h];return arrayPageSize}function tb_detectMacXFF(){var a=navigator.userAgent.toLowerCase();if(a.indexOf('mac')!=-1&&a.indexOf('firefox')!=-1){return true}}function thickBox_init(o){tb_init('a.thickbox, area.thickbox, input.thickbox',o);tb_imgLoader=new Image();tb_imgLoader.src="/images/jqueryPublic/tb_loadingAnimation.gif"}
function ajaxUpdata_fun(){var objAction=$(this);var fieldType=objAction.attr("fieldType");if(fieldType=="bool"){$.ajax({url:"/ajax/admin_updateFieldValue.aspx?rnd="+getRndNum(1,99999),data:"table="+$("#ajaxUpdata_dbTable").val()+"&IDValue="+objAction.attr("IDValue")+"&fieldName="+objAction.attr("fieldName")+"&fieldType="+fieldType,type:"POST",async:true,dataType:"json",success:function(json){if(json.success){if(objAction.html().indexOf("/yes")>0){objAction.html("<img src='/images/jqueryPublic/no10.gif' border='0' />")}else{objAction.html("<img src='/images/jqueryPublic/yes10.gif' border='0' />")}}else{alert("抱歉，更新失败，请重试！")}}})}else{var objOldText=objAction.text();var objInput=$("<input>");objInput.attr("value",objOldText);objInput.attr("class",objAction.attr("inputClass"));objAction.html(objInput);objInput.blur(function(){objAction.html("<img src='/images/jqueryPublic/loading5.gif' width='10' height='10' align='absmiddle' />");var inputText=objInput.val();if(inputText==objOldText){objAction.html(inputText)}else{$.ajax({url:"/ajax/admin_updateFieldValue.aspx?rnd="+getRndNum(1,99999),data:"table="+$("#ajaxUpdata_dbTable").val()+"&IDValue="+objAction.attr("IDValue")+"&fieldName="+objAction.attr("fieldName")+"&value="+escape(inputText),type:"POST",async:true,dataType:"json",success:function(json){if(json.success){objAction.html(inputText)}else{alert("抱歉，更新失败，请重试！");objAction.html(objOldText)}}})}objAction.click(ajaxUpdata_fun)});objInput.keyup(function(event){var myEvent=event||window.event;var keyCode=myEvent.keyCode;if(keyCode==27){objInput.val(objOldText)}});objInput.get(0).select();objAction.unbind("click")}}
$.fn.extend({selected:function(s){var tmp=s.split(',');for(i=0;i<this[0].length;i++){for(j=0;j<tmp.length;j++){if(this[0][i].value==tmp[j]){this[0][i].selected=true;break}else{this[0][i].selected=false}}}},selectAll:function(s){for(i=0;i<this[0].length;i++){this[0][i].selected=s}},checked:function(s){$(this).each(function(){$(this)[0].checked=(s.indexOf($(this)[0].value)>=0)})},checkAll:function(s,bt_id){$(this).each(function(){$(this)[0].checked=s});if(bt_id){$(bt_id).each(function(i){$(bt_id)[i].disabled=!s})}},checkItem:function(s,bt_id){var flag=true;var bt_flag=false;$('input[name="'+this[0].name+'"]').each(function(){if(!this.checked){flag=false}else{bt_flag=true}});if(bt_id){if(bt_flag){$(bt_id).each(function(i){$(bt_id)[i].disabled=false})}else{$(bt_id).each(function(i){$(bt_id)[i].disabled=true})}}$(s)[0].checked=flag}});
$.fn.extend({ checkboxChecked: function(s) { var tmp = s.split(','); $(this).each(function() { for (j = 0; j < tmp.length; j++) { if (this.value == tmp[j]) { this.checked = true; break } else { this.checked = false } } }) } });

function CDecimal(num, Len) {
    var temp = Math.pow(10, Len);
    return Math.round(num * temp) / temp
}

jQuery.fn.FN_CheckboxSelect = function(type) {
    var t = type || "on";
    this.each(function() {
        switch (t) {
        case "on":
            this.checked = true;
            break;
        case "off":
            this.checked = false;
            break;
        case "toggle":
            this.checked = !this.checked;
            break;
        }
    });
}
function IsValue(val){
	return isValue(val);
}